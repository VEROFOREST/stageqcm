{% extends 'base.html.twig' %}
{% form_theme form 'bootstrap_4_layout.html.twig' %}
{% block title %}nouveau Questionnaire{% endblock %}

{% block body %}
{% include "questionnaire/_form.html.twig" %}
 
  {% block javascripts %}
  {# {{parent()}} #}
  <script>
// pour pouvoir afficher autant de form question que de nombre rentrer dans l'input  

$(document).ready(function() {
                 
            
            var $wrapperquestion = $('.questionwrapper');
            var nbrequestion = document.querySelector('#questionnaire_global_questionnaire_nbreQuestion');
            $wrapperquestion.on('click', ".jsaddquestion", function(e) {
                
                e.preventDefault();
              

             console.log("ppl1question") 
             console.log(nbrequestion.value);
           
                
                var prototype = $wrapperquestion.data('prototype'); 
                 console.log("ppl2question") ;
        //         // get the new index
                var index = $wrapperquestion.data('index'); 
                console.log("ppl3question");
                // Replace '__name__' in the prototype's HTML to
        //         // instead be a number based on how many items we have
                var newForm = prototype.replace(/__name__/g, index); 
        //         // augmente l'index jusqu'à ce qu'il soit égal au nbre de question.
                
               //while ( index>=nbrequestion.value){
               $wrapperquestion.data('index', index+1);
                 console.log("ppl3question",index); 
        //         // Display the form in the page before the "new" link
             // }
           
                
                return $(this).before(newForm); 
                }); 
        });  
 
  // js pour afficher autant de reponses possibles que de choix mis dans input nombre de choix  
         $(document).ready(function() {
                 
                
            var $wrapperreponse = $('.reponsewrapper');

             console.log("ppl1") 

            $wrapperreponse.on('click', ".jsaddreponse", function(e) {
          e.preventDefault(); 
         //        var nbrequestion=$('input[id="questionnaire_global_question_0_baremeQuestion"]').val(); 
        //        console.log(nbrequestion); 
                 var prototype = $wrapperreponse.data('prototype');  
                  console.log("ppl2")  
        //         // get the new index
                 var index = $wrapperreponse.data('index');  
                  console.log("ppl3",index)  
                // Replace '__name__' in the prototype's HTML to
        //         // instead be a number based on how many items we have
                 var newForm = prototype.replace(/__name__/g, index);  
        //         // increase the index with one for the next item
                               
                 $wrapperreponse.data('index', index+1);  
        //         // Display the form in the page before the "new" link
                 return $(this).before(newForm);  
                 } 
             );  
         });   
     
        </script>
    {% endblock %}
{% endblock %}
